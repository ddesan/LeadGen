(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b(require("@babel/runtime/helpers/objectSpread"),require("@babel/runtime/helpers/objectWithoutProperties"),require("@babel/runtime/helpers/classCallCheck"),require("@babel/runtime/helpers/createClass"),require("@babel/runtime/helpers/possibleConstructorReturn"),require("@babel/runtime/helpers/getPrototypeOf"),require("@babel/runtime/helpers/assertThisInitialized"),require("@babel/runtime/helpers/inherits"),require("@babel/runtime/helpers/defineProperty"),require("react"),require("prop-types")):"function"==typeof define&&define.amd?define(["@babel/runtime/helpers/objectSpread","@babel/runtime/helpers/objectWithoutProperties","@babel/runtime/helpers/classCallCheck","@babel/runtime/helpers/createClass","@babel/runtime/helpers/possibleConstructorReturn","@babel/runtime/helpers/getPrototypeOf","@babel/runtime/helpers/assertThisInitialized","@babel/runtime/helpers/inherits","@babel/runtime/helpers/defineProperty","react","prop-types"],b):(a=a||self,a.Img=b(a._objectSpread,a._objectWithoutProperties,a._classCallCheck,a._createClass,a._possibleConstructorReturn,a._getPrototypeOf,a._assertThisInitialized,a._inherits,a._defineProperty,a.React,a.propTypes))})(this,function(a,b,c,d,e,f,g,h,j,k,l){'use strict';a=a&&a.hasOwnProperty("default")?a["default"]:a,b=b&&b.hasOwnProperty("default")?b["default"]:b,c=c&&c.hasOwnProperty("default")?c["default"]:c,d=d&&d.hasOwnProperty("default")?d["default"]:d,e=e&&e.hasOwnProperty("default")?e["default"]:e,f=f&&f.hasOwnProperty("default")?f["default"]:f,g=g&&g.hasOwnProperty("default")?g["default"]:g,h=h&&h.hasOwnProperty("default")?h["default"]:h,j=j&&j.hasOwnProperty("default")?j["default"]:j;var m="default"in k?k["default"]:k,n={},o={loader:l.node,unloader:l.node,decode:l.bool,crossorigin:l.string,src:l.oneOfType([l.string,l.array]),container:l.func,loaderContainer:l.func,unloaderContainer:l.func},p=function(i){function k(a){var b;c(this,k),b=e(this,f(k).call(this,a)),j(g(b),"srcToArray",function(a){return(Array.isArray(a)?a:[a]).filter(function(a){return a})}),j(g(b),"onLoad",function(){n[b.sourceList[b.state.currentIndex]]=!0,b.i&&b.setState({isLoaded:!0})}),j(g(b),"onError",function(){if(n[b.sourceList[b.state.currentIndex]]=!1,!b.i)return!1;for(var a,c=b.state.currentIndex+1;c<b.sourceList.length;c++){if(a=b.sourceList[c],!(a in n)){b.setState({currentIndex:c});break}if(!0===n[a])return b.setState({currentIndex:c,isLoading:!1,isLoaded:!0}),!0;!1===n[a]}return c===b.sourceList.length?b.setState({isLoading:!1}):void b.loadImg()}),j(g(b),"loadImg",function(){b.i=new Image,b.i.src=b.sourceList[b.state.currentIndex],b.props.crossorigin&&(b.i.crossorigin=b.props.crossorigin),b.props.decode&&b.i.decode?b.i.decode().then(b.onLoad)["catch"](b.onError):(b.i.onload=b.onLoad,b.i.onerror=b.onError)}),j(g(b),"unloadImg",function(){b.i.onerror=null,b.i.onload=null,b.i.src="";try{delete b.i.src}catch(a){}delete b.i}),b.loaderContainer=a.loaderContainer||a.container,b.unloaderContainer=a.unloaderContainer||a.container,b.sourceList=b.srcToArray(b.props.src);for(var d=0;d<b.sourceList.length&&!!(b.sourceList[d]in n);d++)if(!0===n[b.sourceList[d]])return b.state={currentIndex:d,isLoading:!1,isLoaded:!0},e(b);return b.state=b.sourceList.length?{currentIndex:0,isLoading:!0,isLoaded:!1}:{isLoading:!1,isLoaded:!1},b}return h(k,i),d(k,[{key:"componentDidMount",value:function(){this.state.isLoading&&this.loadImg()}},{key:"componentWillUnmount",value:function(){this.i&&this.unloadImg()}},{key:"componentWillReceiveProps",value:function(a){var b=this;this.loaderContainer=a.loaderContainer||a.container,this.unloaderContainer=a.unloaderContainer||a.container;var c=this.srcToArray(a.src),d=c.filter(function(a){return-1===b.sourceList.indexOf(a)}),e=this.sourceList.filter(function(a){return-1===c.indexOf(a)});if(d.length||e.length){if(this.sourceList=c,!c.length)return this.setState({isLoading:!1,isLoaded:!1});this.setState({currentIndex:0,isLoading:!0,isLoaded:!1},this.loadImg)}}},{key:"render",value:function(){var c=this.props,d=c.container,e=c.loader,f=c.unloader,g=c.src,h=c.crossorigin,i=c.decode,j=c.loaderContainer,k=c.unloaderContainer,l=c.mockImage,n=b(c,["container","loader","unloader","src","crossorigin","decode","loaderContainer","unloaderContainer","mockImage"]);if(this.state.isLoaded){var o=a({},{src:this.sourceList[this.state.currentIndex]},n);return d(m.createElement("img",o))}return!this.state.isLoaded&&this.state.isLoading?e?this.loaderContainer(e):null:this.state.isLoaded||this.state.isLoading?void 0:f?this.unloaderContainer(f):null}}]),k}(k.Component);return j(p,"defaultProps",{loader:!1,unloader:!1,decode:!0,src:[],container:function(a){return a}}),p.propTypes={},p});
//# sourceMappingURL=index.js.map
